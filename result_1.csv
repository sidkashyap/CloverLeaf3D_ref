Source Line,Source,CPU_CLK_UNHALTED.THREAD_ANY,OFFCORE_RESPONSE:request=ALL_DATA_RD:response=L3_MISS.ANY_DRAM,CYCLE_ACTIVITY.CYCLES_NO_EXECUTE,CYCLE_ACTIVITY.STALLS_L2_PENDING,MEM_LOAD_UOPS_L3_MISS_RETIRED.LOCAL_DRAM_PS,MEM_LOAD_UOPS_RETIRED.L1_HIT_PS,MEM_LOAD_UOPS_RETIRED.L1_MISS_PS,MEM_LOAD_UOPS_RETIRED.L2_HIT_PS,MEM_LOAD_UOPS_RETIRED.L2_MISS_PS,MEM_LOAD_UOPS_RETIRED.L3_HIT,MEM_LOAD_UOPS_RETIRED.L3_HIT_PS,MEM_LOAD_UOPS_RETIRED.L3_MISS,MEM_LOAD_UOPS_RETIRED.L3_MISS_PS,MEM_UOPS_RETIRED.ALL_LOADS_PS,MEM_UOPS_RETIRED.ALL_STORES,MEM_UOPS_RETIRED.ALL_STORES_PS,CPU_CLK_UNHALTED.THREAD_ANY,CPU_CLK_UNHALTED.REF_TSC,CYCLE_ACTIVITY.STALLS_L1D_PENDING,OFFCORE_RESPONSE:request=ALL_DATA_RD:response=L3_MISS.ANY_DRAM,CYCLE_ACTIVITY.CYCLES_NO_EXECUTE,CYCLE_ACTIVITY.STALLS_L2_PENDING,L2_RQSTS.MISS,MISALIGN_MEM_REF.LOADS,MISALIGN_MEM_REF.STORES,CYCLE_ACTIVITY.STALLS_LDM_PENDING,MEM_LOAD_UOPS_L3_MISS_RETIRED.LOCAL_DRAM_PS,MEM_LOAD_UOPS_RETIRED.L1_HIT_PS,MEM_LOAD_UOPS_RETIRED.L1_MISS_PS,RESOURCE_STALLS.SB,RS_EVENTS.EMPTY_CYCLES,UOPS_RETIRED.ALL,UOPS_RETIRED.RETIRE_SLOTS,MEM_LOAD_UOPS_RETIRED.L2_HIT_PS,MEM_LOAD_UOPS_RETIRED.L2_MISS_PS,MEM_LOAD_UOPS_RETIRED.L3_HIT,MEM_LOAD_UOPS_RETIRED.L3_HIT_PS,MEM_LOAD_UOPS_RETIRED.L3_MISS,MEM_LOAD_UOPS_RETIRED.L3_MISS_PS,MEM_UOPS_RETIRED.ALL_LOADS_PS,MEM_UOPS_RETIRED.ALL_STORES,MEM_UOPS_RETIRED.ALL_STORES_PS,Total_Latency_MEM_LOAD_UOPS_RETIRED.L2_MISS_PS,Total_Latency_MEM_LOAD_UOPS_RETIRED.L3_HIT_PS,Total_Latency_MEM_LOAD_UOPS_RETIRED.L3_MISS_PS,Total_Latency_MEM_LOAD_UOPS_RETIRED.L1_MISS_PS,Total_Latency_MEM_LOAD_UOPS_L3_MISS_RETIRED.LOCAL_DRAM_PS
1,!Crown Copyright 2012 AWE.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
2,!,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
3,! This file is part of CloverLeaf.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
4,!,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
5,! CloverLeaf is free software: you can redistribute it and/or modify it under ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
6,! the terms of the GNU General Public License as published by the ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
7,"! Free Software Foundation, either version 3 of the License, or (at your option) ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
8,! any later version.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
9,!,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
10,"! CloverLeaf is distributed in the hope that it will be useful, but ",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
11,! WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
12,! FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
13,! details.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
14,!,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
15,! You should have received a copy of the GNU General Public License along with ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
16,"! CloverLeaf. If not, see http://www.gnu.org/licenses/.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
17,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
18,!>  @brief Fortran momentum advection kernel,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
19,!>  @author Wayne Gaudin,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
20,!>  @details Performs a second order advective remap on the vertex momentum,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
21,!>  using van-Leer limiting and directional splitting.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
22,"!>  Note that although pre_vol is only set and not used in the update, please",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
23,!>  leave it in the method.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
24,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
25,MODULE advec_mom_kernel_mod,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
26,USE OMP_LIB,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
27,CONTAINS,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
28,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
29,"SUBROUTINE advec_mom_kernel(flop,                           &",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
30,"                            mem,                            &",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
31,"                            x_min,x_max,y_min,y_max,z_min,z_max, &",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
32,"                            vel1,                                &",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
33,"                            mass_flux_x,                         &",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
34,"                            vol_flux_x,                          &",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
35,"                            mass_flux_y,                         &",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
36,"                            vol_flux_y,                          &",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
37,"                            mass_flux_z,                         &",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
38,"                            vol_flux_z,                          &",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
39,"                            volume,                              &",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
40,"                            density1,                            &",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
41,"                            node_flux,                           &",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
42,"                            node_mass_post,                      &",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
43,"                            node_mass_pre,                       &",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
44,"                            advec_vel,                           &",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
45,"                            mom_flux,                            &",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
46,"                            pre_vol,                             &",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
47,"                            post_vol,                            &",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
48,"                            celldx,                              &",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
49,"                            celldy,                              &",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
50,"                            celldz,                              &",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
51,"                            advect_x,                            &",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
52,"                            which_vel,                           &",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
53,"                            sweep_number,                        &",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
54,                            direction                            ),,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
55,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
56,  IMPLICIT NONE,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
57,  ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
58,"  INTEGER :: x_min,x_max,y_min,y_max,z_min,z_max",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
59,"  INTEGER :: which_vel,sweep_number,direction",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
60,  LOGICAL :: advect_x,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
61,"  INTEGER (KIND=8) :: flop,tmpFlop,mem,tmpMem,iter,limiter_count",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
62,"  REAL(KIND=8), TARGET,DIMENSION(x_min-2:x_max+3,y_min-2:y_max+3,z_min-2:z_max+3) :: vel1",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
63,"  REAL(KIND=8), DIMENSION(x_min-2:x_max+3,y_min-2:y_max+2,z_min-2:z_max+2) :: mass_flux_x",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
64,"  REAL(KIND=8), DIMENSION(x_min-2:x_max+3,y_min-2:y_max+2,z_min-2:z_max+2) :: vol_flux_x",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
65,"  REAL(KIND=8), DIMENSION(x_min-2:x_max+2,y_min-2:y_max+3,z_min-2:z_max+2) :: mass_flux_y",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
66,"  REAL(KIND=8), DIMENSION(x_min-2:x_max+2,y_min-2:y_max+3,z_min-2:z_max+2) :: vol_flux_y",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
67,"  REAL(KIND=8), DIMENSION(x_min-2:x_max+2,y_min-2:y_max+2,z_min-2:z_max+3) :: mass_flux_z",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
68,"  REAL(KIND=8), DIMENSION(x_min-2:x_max+2,y_min-2:y_max+2,z_min-2:z_max+3) :: vol_flux_z",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
69,"  REAL(KIND=8), DIMENSION(x_min-2:x_max+2,y_min-2:y_max+2,z_min-2:z_max+2) :: volume",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
70,"  REAL(KIND=8), DIMENSION(x_min-2:x_max+2,y_min-2:y_max+2,z_min-2:z_max+2) :: density1",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
71,"  REAL(KIND=8), DIMENSION(x_min-2:x_max+3,y_min-2:y_max+3,z_min-2:z_max+3) :: node_flux",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
72,"  REAL(KIND=8), DIMENSION(x_min-2:x_max+3,y_min-2:y_max+3,z_min-2:z_max+3) :: node_mass_post",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
73,"  REAL(KIND=8), DIMENSION(x_min-2:x_max+3,y_min-2:y_max+3,z_min-2:z_max+3) :: node_mass_pre",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
74,"  REAL(KIND=8), DIMENSION(x_min-2:x_max+3,y_min-2:y_max+3,z_min-2:z_max+3) :: advec_vel",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
75,"  REAL(KIND=8), DIMENSION(x_min-2:x_max+3,y_min-2:y_max+3,z_min-2:z_max+3) :: mom_flux",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
76,"  REAL(KIND=8), DIMENSION(x_min-2:x_max+3,y_min-2:y_max+3,z_min-2:z_max+3) :: pre_vol",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
77,"  REAL(KIND=8), DIMENSION(x_min-2:x_max+3,y_min-2:y_max+3,z_min-2:z_max+3) :: post_vol",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
78,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
79,"  REAL(KIND=8), DIMENSION(x_min-2:x_max+2) :: celldx",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
80,"  REAL(KIND=8), DIMENSION(y_min-2:y_max+2) :: celldy",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
81,"  REAL(KIND=8), DIMENSION(z_min-2:z_max+2) :: celldz",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
82, ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
83,"  INTEGER :: j,k,l,bj,bk,bl,BLOCK_SIZE,nb_x,nb_y,nb_z,block_max",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
84,"  INTEGER :: upwind,donor,downwind,dif",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
85,"  REAL(KIND=8) :: sigma,wind,width,tmp1,tmp2,tmp3,tmp4,tmp5",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
86,"  REAL(KIND=8) :: vdiffuw,vdiffdw,auw,adw,limiter",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
87,"  REAL(KIND=8) :: vdiffuw2,vdiffdw2,auw2,limiter2, advec_vel_s",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
88,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
89,"  ! Choose the correct velocity, ideally, remove this pointer",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
90,  !  if it affects performance.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
91,  ! Leave this one in as a test of performance,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
92,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
93,  flop=0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
94,  tmpFlop=0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
95,  BLOCK_SIZE=32,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
96,!$OMP PARALLEL,16000024,0,30000045,30000045,0,0,0,0,0,0,0,0,0,5000015,0,0,8,3,2,0,3,3,0,0,0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0
97,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
98,! I think these only have to be done once per cell advection sweep. So put in some logic so they are just done the first time,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
99,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
100,  IF(sweep_number.EQ.1.AND.direction.EQ.1)THEN ! x first,4000006,0,0,0,0,0,500015,0,0,0,0,0,0,0,0,0,2,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0
101,!$OMP DO,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1000015,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0
102,"    DO l=z_min-2,z_max+2",12000018,0,10000015,0,0,0,0,0,0,0,0,0,0,0,0,1000015,6,1,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0
103,"      DO k=y_min-2,y_max+2",26000039,0,20000030,10000015,0,10000015,0,0,0,0,0,500015,0,25000075,0,0,13,3,2,0,2,1,2,0,0,1,0,1,0,0,0,7,1,0,0,0,0,1,0,5,0,0,0,0,0,0,0
104,"        DO j=x_min-2,x_max+2",458000687,0,320000480,270000405,0,60000090,0,0,0,2250945,0,500015,0,40000120,10000015,0,229,136,11,0,32,27,19,0,0,15,0,6,0,7,19,51,38,0,0,9,0,1,0,8,1,0,0,0,0,0,0
105,"          post_vol(j,k,l)= volume(j,k,l)+vol_flux_y(j  ,k+1,l  )-vol_flux_y(j,k,l) &",28496042744,0,25060037590,24220036330,27000810,2700004050,98002940,48501455,49770895,30762915,27501650,22500675,22501350,3490010470,580000870,885013275,14248,8594,2407,0,2506,2422,762,0,0,2327,54,270,196,110,72,1048,702,97,199,123,110,45,90,698,58,885,199,109,90,196,54
106,"                                        +vol_flux_z(j  ,k  ,l+1)-vol_flux_z(j,k,l)",15280022920,0,13160019740,13510020265,11500345,1730002595,67002010,34501035,41767535,17757455,25751545,16000480,13000780,2560007680,440000660,0,7640,4713,1357,0,1316,1351,414,0,0,1330,23,173,134,30,36,538,394,69,167,71,103,32,52,512,44,0,167,103,51,134,22
107,"          pre_vol(j,k,l)=post_vol(j,k,l)+vol_flux_x(j+1,k  ,l  )-vol_flux_x(j,k,l)",9792014688,0,8100012150,7310010965,12000360,1950002925,33501005,10000300,23509870,15256405,8500510,9500285,11000660,2420007260,130000195,390005850,4896,2981,682,0,810,731,238,0,0,666,24,195,67,98,98,378,308,20,94,61,34,19,44,484,13,390,94,34,44,67,24
108,        ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
109,      ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
110,    ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
111,!$OMP END DO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
112,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
113,!$OMP MASTER,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
114,  iter=(z_max-z_min+5)*(y_max-y_min+5)*(x_max-x_min+5),,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
115,  tmpFlop=iter*6 !sc - 16464,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
116,  tmpMem=iter*10,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
117,!$OMP END MASTER,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
118,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
119,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
120,  ELSEIF(sweep_number.EQ.1.AND.direction.EQ.3)THEN ! z first,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
121,!$OMP DO,0,0,0,0,0,0,0,0,0,250105,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0
122,"    DO l=z_min-2,z_max+2",6000009,0,20000030,10000015,0,0,0,0,0,0,0,0,0,0,0,0,3,2,0,0,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
123,"      DO k=y_min-2,y_max+2",24000036,0,0,10000015,0,30000045,500015,0,0,250105,250015,0,0,20000060,0,0,12,10,2,0,0,1,1,0,0,3,0,3,1,0,1,5,0,0,0,1,1,0,0,4,0,0,0,1,0,1,0
124,"        DO j=x_min-2,x_max+2",440000660,0,290000435,190000285,0,50000075,0,0,0,250105,0,2000060,250015,65000195,30000045,0,220,119,14,0,29,19,16,0,0,16,0,5,0,15,12,43,28,0,0,1,0,4,1,13,3,0,0,0,1,0,0
125,"          post_vol(j,k,l)= volume(j,k,l)+vol_flux_x(j+1,k  ,l  )-vol_flux_x(j,k,l) &",28838043257,0,24780037170,24410036615,21000630,2780004170,75002250,36001080,41767535,33263965,22251335,21000630,22001320,3630010890,520000780,838012570,14419,8808,2420,0,2478,2441,745,0,0,2515,42,278,150,98,77,1015,775,72,167,133,89,42,88,726,52,838,166,89,88,150,42
126,"                                        +vol_flux_y(j  ,k+1,l  )-vol_flux_y(j,k,l)",10880016320,0,10610015915,10150015225,15000450,1800002700,42501275,13000390,21759135,13505670,8750525,10500315,11250675,2300006900,360000540,0,5440,3256,971,0,1061,1015,287,0,0,924,30,180,85,34,28,394,273,26,87,54,35,21,45,460,36,0,87,35,45,85,30
127,"          pre_vol(j,k,l)=post_vol(j,k,l)+vol_flux_z(j  ,k  ,l+1)-vol_flux_z(j,k,l)",13594020391,0,10290015435,10230015345,15500465,1670002505,85502565,22500675,46769635,17257245,28001680,13000390,13000780,2735008205,400000600,414006210,6797,4102,1002,0,1029,1023,396,0,0,977,31,167,171,123,112,603,419,45,187,69,112,26,52,547,40,414,187,112,52,171,30
128,        ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
129,      ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
130,    ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
131,!$OMP END DO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
132,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
133,!$OMP MASTER,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
134,  iter=(z_max-z_min+1+4)*(y_max-y_min+1+4)*(x_max-x_min+1+4),,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
135,  tmpFlop=iter*6,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
136,  tmpMem=iter*10,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
137,!$OMP END MASTER,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
138,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
139,  ELSEIF(sweep_number.EQ.2.AND.advect_x)THEN ! x first,10000015,0,0,0,0,0,0,0,250105,0,0,0,0,0,0,0,5,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0
140,!$OMP DO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
141,"    DO l=z_min-2,z_max+2",4000006,0,20000030,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,1,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
142,"      DO k=y_min-2,y_max+2",48000072,0,30000045,20000030,0,20000030,0,0,250105,0,0,0,0,15000045,10000015,0,24,7,1,0,3,2,1,0,0,1,0,2,0,0,0,4,1,0,1,0,0,0,0,3,1,0,1,0,0,0,0
143,"        DO j=x_min-2,x_max+2",334000501,0,160000240,150000225,0,0,0,0,0,1000420,0,0,0,0,10000015,0,167,76,9,0,16,15,10,0,0,12,0,0,0,3,4,30,29,0,0,4,0,0,0,0,1,0,0,0,0,0,0
144,"          post_vol(j,k,l)=volume(j,k,l) +vol_flux_z(j  ,k  ,l+1)-vol_flux_z(j,k,l)",31058046587,0,27740041610,26870040305,34001020,2540003810,126003780,62501875,65277405,30762915,46002760,22000660,26501590,4120012360,820001230,1134017010,15529,9509,2636,0,2774,2687,807,0,0,2635,68,254,252,240,96,975,730,125,261,123,184,44,106,824,82,1134,261,184,105,252,68
145,"          pre_vol(j,k,l)=post_vol(j,k,l)+vol_flux_y(j  ,k+1,l  )-vol_flux_y(j,k,l)",15654023481,0,13310019965,11750017625,13500405,2120003180,48001440,14000420,27011340,17257245,9250555,15000450,12250735,2070006210,430000645,94001410,7827,4659,1128,0,1331,1175,384,0,0,1131,27,212,96,278,221,527,369,28,108,69,37,30,49,414,43,94,108,37,49,96,26
146,        ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
147,      ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
148,    ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
149,!$OMP END DO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
150,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
151,!$OMP MASTER,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
152, iter=(z_max-z_min+1+4)*(y_max-y_min+1+4)*(x_max-x_min+1+4),,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
153, tmpFlop=iter*4,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
154, tmpMem=iter*8,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
155, !$OMP END MASTER,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
156,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
157,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
158,  ELSEIF(sweep_number.EQ.2.AND..NOT.advect_x)THEN ! Z first,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
159,!$OMP DO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
160,"    DO l=z_min-2,z_max+2",4000006,0,0,0,0,0,500015,0,0,0,0,0,0,0,0,0,2,5,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0
161,"      DO k=y_min-2,y_max+2",20000030,0,10000015,10000015,0,20000030,0,0,250105,0,0,500015,0,35000105,0,0,10,12,1,0,1,1,1,0,0,2,0,2,0,0,0,3,1,0,1,0,0,1,0,7,0,0,1,0,0,0,0
162,"        DO j=x_min-2,x_max+2",326000489,0,160000240,80000120,0,0,0,0,0,250105,0,500015,0,10000030,20000030,0,163,83,8,0,16,8,12,0,0,12,0,0,0,2,11,38,14,0,0,1,0,1,0,2,2,0,0,0,0,0,0
163,"          post_vol(j,k,l)=volume(j,k,l) +vol_flux_x(j+1,k  ,l  )-vol_flux_x(j,k,l)",28966043449,0,25150037725,24250036375,21000630,2450003675,71002130,33501005,41017220,13505670,17001020,26000780,20251215,3625010875,780001170,1134017010,14483,8946,2416,0,2515,2425,624,0,0,2445,42,245,142,262,130,933,714,67,164,54,68,52,81,725,78,1134,163,68,81,142,42
164,"          pre_vol(j,k,l)=post_vol(j,k,l)+vol_flux_y(j  ,k+1,l  )-vol_flux_y(j,k,l)",17104025656,0,14220021330,12560018840,8000240,1840002760,29500885,11000330,14506090,11254725,7500450,8000240,9250555,2355007065,390000585,125001875,8552,4969,1129,0,1422,1256,366,0,0,1158,16,184,59,371,288,582,407,22,58,45,30,16,37,471,39,125,58,30,37,59,16
165,        ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
166,      ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
167,    ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
168,!$OMP END DO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
169,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
170,!$OMP MASTER,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
171,  iter=(z_max-z_min+1+4)*(y_max-y_min+1+4)*(x_max-x_min+1+4),2000003,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
172,  tmpFlop=iter*4,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
173,  tmpMem=iter*8,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
174,!$OMP END MASTER,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
175,  ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
176,  ELSEIF(sweep_number.EQ.3.AND.direction.EQ.1)THEN ! z first,0,0,10000015,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
177,!$OMP DO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
178,"    DO l=z_min-2,z_max+2",4000006,0,10000015,20000030,0,0,0,0,0,0,0,0,0,0,0,0,2,1,0,0,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
179,"      DO k=y_min-2,y_max+2",38000057,0,10000015,10000015,500015,20000030,0,0,250105,0,0,0,0,20000060,10000015,0,19,13,1,0,1,1,1,0,0,6,1,2,0,0,1,0,1,0,1,0,0,0,0,4,1,0,1,0,0,0,1
180,"        DO j=x_min-2,x_max+2",406000609,0,240000360,140000210,0,20000030,0,0,0,0,0,500015,0,10000030,40000060,0,203,139,7,0,24,14,7,0,0,19,0,2,0,9,9,29,19,0,0,0,0,1,0,2,4,0,0,0,0,0,0
181,"          post_vol(j,k,l)=volume(j,k,l)",11880017820,0,10670016005,9720014580,18000540,940001410,46001380,17000510,21509030,3501470,7500450,9500285,17751065,1820005460,360000540,1017015255,5940,3539,928,0,1067,972,249,0,0,947,36,94,92,328,158,314,204,34,86,14,30,19,71,364,36,1017,86,30,71,92,36
182,"          pre_vol(j,k,l)=post_vol(j,k,l)+vol_flux_x(j+1,k  ,l  )-vol_flux_x(j,k,l)",27024040536,0,23800035700,20150030225,14500435,1250001875,28500855,14000420,18257665,12255145,9250555,15000450,14500870,1925005775,880001320,251003765,13512,8155,1835,0,2380,2015,542,0,0,1869,29,125,57,920,502,689,465,28,73,49,37,30,58,385,88,251,72,37,57,57,28
183,        ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
184,      ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
185,    ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
186,!$OMP END DO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
187,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
188,!$OMP MASTER,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
189,  iter=(z_max-z_min+1+4)*(y_max-y_min+1+4)*(x_max-x_min+1+4),,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
190,  tmpFlop=iter*2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
191,  tmpMem=iter*6,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
192,!$OMP END MASTER,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
193,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
194,  ELSEIF(sweep_number.EQ.3.AND.direction.EQ.3)THEN ! x first,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
195,!$OMP DO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
196,"    DO l=z_min-2,z_max+2",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
197,"      DO k=y_min-2,y_max+2",34000051,0,40000060,10000015,0,20000030,0,0,250105,0,0,0,0,20000060,0,0,17,8,1,0,4,1,1,0,0,1,0,2,0,0,0,2,1,0,1,0,0,0,0,4,0,0,1,0,0,0,0
198,"        DO j=x_min-2,x_max+2",414000621,0,350000525,250000375,0,0,0,0,0,500210,0,1500045,0,5000015,40000060,0,207,127,12,0,35,25,18,0,0,16,0,0,0,15,11,26,21,0,0,2,0,3,0,1,4,0,0,0,0,0,0
199,"          post_vol(j,k,l)=volume(j,k,l)",9396014094,0,8750013125,7830011745,20000600,890001335,45501365,11500345,39016380,14255985,13000780,11500345,18751125,1740005220,270000405,936014040,4698,2912,801,0,875,783,274,0,0,756,40,89,91,246,92,239,165,23,156,57,52,23,75,348,27,936,156,52,75,91,40
200,"          pre_vol(j,k,l)=post_vol(j,k,l)+vol_flux_z(j  ,k  ,l+1)-vol_flux_z(j,k,l)",30002045003,0,25850038775,23370035055,20500615,1280001920,102003060,47501425,58274465,31513230,41502490,27500825,21001260,2040006120,930001395,298004470,15001,8996,2159,0,2585,2337,731,0,0,2184,41,128,204,1022,437,748,518,95,233,126,166,55,84,408,93,298,233,164,83,204,41
201,        ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
202,      ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
203,    ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
204,!$OMP END DO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
205,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
206,!$OMP MASTER,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
207,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
208,  iter=(z_max-z_min+1+4)*(y_max-y_min+1+4)*(x_max-x_min+1+4),,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
209,  tmpFlop=iter*2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
210,  tmpMem=iter*6,2000003,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
211,!$OMP END MASTER,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
212,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
213,  ENDIF,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
214,  !$OMP MASTER,2000003,0,10000015,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
215,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
216,  flop=flop+tmpFlop,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
217,  mem=mem+tmpMem ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
218,  tmpFlop=0  ,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
219,  tmpMem=0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
220,  !$OMP END MASTER,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
221,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
222,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
223,!----------------------------------- PRE and POST Volume calculation complete ----------------------------------,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
224,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
225,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
226,  IF(direction.EQ.1)THEN,18000027,0,10000015,0,0,0,0,0,0,0,0,0,0,0,0,0,9,2,2,0,1,0,0,0,0,2,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
227,    IF(which_vel.EQ.1) THEN,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
228,!$OMP DO,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
229,"      DO l=z_min,z_max+1",0,0,0,10000015,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
230,"        DO k=y_min,y_max+1",16000024,0,20000030,10000015,0,30000045,0,0,0,0,0,0,0,45000135,0,0,8,4,0,0,2,1,2,0,0,0,0,3,0,0,0,3,0,0,0,0,0,0,0,9,0,0,0,0,0,0,0
231,"          DO j=x_min-2,x_max+2",192000288,0,40000060,50000075,0,0,0,0,0,500210,0,1500045,0,0,0,0,96,39,7,0,4,5,10,0,0,0,0,0,0,0,2,47,33,0,0,2,0,3,0,0,0,0,0,0,0,0,0
232,"            ! Find staggered mesh mass fluxes, nodal masses and volumes.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
233,"            node_flux(j,k,l)=0.125_8*(mass_flux_x(j  ,k-1,l  )+mass_flux_x(j  ,k,l  )  &",7576011364,0,5640008460,5540008310,500015,1970002955,10000300,6000180,4251785,1750735,3000180,500015,1750105,2125006375,200000300,410006150,3788,2292,536,0,564,554,150,0,0,545,1,197,20,5,5,618,421,12,17,7,12,1,7,425,20,410,17,12,7,20,1
234,"                                     +mass_flux_x(j+1,k-1,l  )+mass_flux_x(j+1,k,l  )  &",2730004095,0,1920002880,1870002805,0,590000885,3000090,2000060,1750735,500210,1500090,1000030,1250075,905002715,70000105,0,1365,811,197,0,192,187,65,0,0,197,0,59,6,0,3,267,195,4,7,2,6,2,5,181,7,0,7,6,5,6,0
235,"                                     +mass_flux_x(j  ,k-1,l-1)+mass_flux_x(j  ,k,l-1)  &",1120001680,0,640000960,670001005,0,1270001905,9000270,4500135,2000840,500210,2250135,0,0,1055003165,60000090,1000015,560,366,55,0,64,67,42,0,0,70,0,127,18,2,3,181,153,9,8,2,9,0,0,211,6,1,8,9,0,18,0
236,"                                     +mass_flux_x(j+1,k-1,l-1)+mass_flux_x(j+1,k,l-1))",1208001812,0,590000885,230000345,500015,1580002370,4500135,2000060,750315,1250525,750045,500015,0,1725005175,70000105,0,604,348,40,0,59,23,51,0,0,45,1,158,9,0,4,244,209,4,3,5,3,1,0,345,7,0,3,3,0,9,1
237,          ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
238,        ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
239,      ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
240,!$OMP END DO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
241,!$OMP MASTER,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
242,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
243,  iter=(z_max-z_min+2)*(y_max-y_min+2)*(x_max-x_min+1+4),,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
244,  tmpFlop=iter*8,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
245,  tmpMem=iter*9,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
246,   flop=flop+tmpFlop !sc 27664,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
247,   mem=mem+tmpMem,0,0,0,10000015,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
248,   tmpFlop=0 ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
249,   tmpMem=0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
250,!$OMP END MASTER,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
251,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
252,"!And do I need to calc the node mass for all 3 directions, or just once?",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
253,!$OMP DO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
254,"      DO l=z_min,z_max+1",4000006,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
255,"        DO k=y_min,y_max+1",34000051,0,0,20000030,0,80000120,0,0,0,0,0,0,250015,90000270,0,0,17,6,1,0,0,2,1,0,0,2,0,8,0,0,0,4,2,0,0,0,0,0,1,18,0,0,0,0,1,0,0
256,"          DO j=x_min-1,x_max+2",532000798,0,120000180,120000180,0,20000030,0,0,0,1000420,0,0,0,15000045,30000045,0,266,172,6,0,12,12,32,0,0,13,0,2,0,0,2,87,53,0,0,4,0,0,0,3,3,0,0,0,0,0,0
257,            ! Staggered cell mass post advection,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
258,"            node_mass_post(j,k,l)=0.125_8*(density1(j  ,k-1,l  )*post_vol(j  ,k-1,l  )                   &",4620006930,0,2340003510,2280003420,0,6980010470,500015,0,500210,750315,500030,1000030,250015,7215021645,120000180,351005265,2310,1393,232,0,234,228,168,0,0,218,0,698,1,0,5,669,571,0,2,3,2,2,1,1443,12,351,2,1,1,1,0
259,"                                          +density1(j  ,k  ,l  )*post_vol(j  ,k  ,l  )                   &",7468011202,0,6300009450,6240009360,2000060,100000150,11000330,5000150,5252205,1500630,3000180,500015,3000180,325000975,40000060,0,3734,2223,641,0,630,624,126,0,0,613,4,10,22,0,3,303,250,10,21,6,12,1,12,65,4,0,21,12,11,22,4
260,"                                          +density1(j-1,k-1,l  )*post_vol(j-1,k-1,l  )                   &",1002001503,0,390000585,250000375,500015,1560002340,0,0,0,250105,0,0,250015,1200003600,140000210,0,501,316,20,0,39,25,52,0,0,28,1,156,0,0,1,211,171,0,0,1,0,0,1,240,14,0,0,0,1,0,1
261,"                                          +density1(j-1,k  ,l  )*post_vol(j-1,k  ,l  )                   &",554000831,0,150000225,80000120,0,850001275,0,0,250105,750315,0,500015,0,870002610,30000045,0,277,174,7,0,15,8,25,0,0,11,0,85,0,0,0,157,122,0,1,3,0,1,0,174,3,0,1,0,0,0,0
262,"                                          +density1(j  ,k-1,l-1)*post_vol(j  ,k-1,l-1)                   &",896001344,0,120000180,120000180,500015,800001200,0,0,250105,1250525,250015,1000030,0,740002220,20000030,0,448,264,6,0,12,12,40,0,0,15,1,80,0,0,1,327,190,0,1,5,1,2,0,148,2,0,1,1,0,0,1
263,"                                          +density1(j  ,k  ,l-1)*post_vol(j  ,k  ,l-1)                   &",1748002622,0,1250001875,1170001755,500015,500000750,12500375,4500135,6002520,1250525,3250195,0,750045,420001260,0,0,874,564,103,0,125,117,48,0,0,107,1,50,25,0,3,216,132,9,24,5,13,0,3,84,0,0,24,13,3,25,1
264,"                                          +density1(j-1,k-1,l-1)*post_vol(j-1,k-1,l-1)                   &",1216001824,0,170000255,110000165,0,450000675,0,0,0,250105,0,0,0,475001425,20000030,0,608,348,12,0,17,11,81,0,0,21,0,45,0,0,1,396,300,0,0,1,0,0,0,95,2,0,0,0,0,0,0
265,"                                          +density1(j-1,k  ,l-1)*post_vol(j-1,k  ,l-1))",730001095,0,160000240,170000255,0,530000795,0,0,0,250105,250015,0,0,490001470,60000090,0,365,229,17,0,16,17,42,0,0,14,0,53,0,0,2,261,186,0,0,1,1,0,0,98,6,0,0,1,0,0,0
266,          ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
267,        ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
268,      ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
269,!$OMP END DO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
270,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
271,!$OMP MASTER,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
272,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
273,      iter=(z_max-z_min+2)*(y_max-y_min+2)*(x_max-x_min+1+3),,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
274,      tmpFlop=iter*16,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
275,      tmpMem=iter*17,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
276,      flop=flop+tmpFlop !sc 48464,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
277,      mem=mem+tmpMem,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
278,      tmpFlop=0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
279,      tmpMem=0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
280,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
281,!$OMP END MASTER,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
282,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
283,!$OMP DO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
284,"      DO l=z_min,z_max+1",0,0,0,0,0,0,0,0,250105,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0
285,"        DO k=y_min,y_max+1",10000015,0,20000030,10000015,0,20000030,500015,0,0,0,0,0,0,30000090,0,0,5,3,0,0,2,1,0,0,0,2,0,2,1,0,0,1,1,0,0,0,0,0,0,6,0,0,0,0,0,1,0
286,"          DO j=x_min-1,x_max+2",110000165,0,110000165,80000120,0,0,0,0,0,250105,0,0,0,0,10000015,0,55,35,3,0,11,8,3,0,0,8,0,0,0,0,0,11,6,0,0,1,0,0,0,0,1,0,0,0,0,0,0
287,            ! Staggered cell mass pre advection,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
288,"            node_mass_pre(j,k,l)=node_mass_post(j,k,l)-node_flux(j-1,k,l)+node_flux(j,k,l)",16168024252,0,14030021045,14160021240,21500645,920001380,56501695,21500645,33263965,17757455,14000840,17000510,19501170,2205006615,320000480,401006015,8084,4847,1395,0,1403,1416,385,0,0,1406,43,92,113,0,14,521,402,43,133,71,56,34,78,441,32,401,133,56,78,113,43
289,          ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
290,        ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
291,      ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
292,!$OMP END DO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
293,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
294,!$OMP MASTER,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
295,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
296,     iter=(z_max-z_min+2)*(y_max-y_min+2)*(x_max-x_min+4),,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
297,     tmpFlop=iter*2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
298,     tmpMem=iter*4,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
299,     flop=flop+tmpFlop !sc 51064,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
300,     mem=mem+tmpMem,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
301,     tmpFlop=0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
302,     tmpMem=0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
303,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
304,!$OMP END MASTER,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
305,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
306,    ENDIF,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
307,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
308,"!$OMP DO PRIVATE(upwind,downwind,donor,dif,sigma,width,limiter,vdiffuw,vdiffdw,auw,adw,wind) REDUCTION (+:limiter_count)",2000003,0,10000015,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
309,"    DO l=z_min,z_max+1",4000006,0,10000015,0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,1,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
310,"      DO k=y_min,y_max+1",42000063,0,10000015,0,0,10000015,0,500015,250105,0,500030,0,0,5000015,10000015,0,21,9,1,0,1,0,0,0,0,0,0,1,0,0,1,2,1,1,1,0,2,0,0,1,1,0,1,2,0,0,0
311,"        DO j=x_min-1,x_max+1",2110003165,0,680001020,110000165,0,15260022890,500015,500015,250105,250105,500030,1000030,0,14520043560,0,2000030,1055,661,7,0,68,11,28,0,0,29,0,1526,1,0,11,122,93,1,1,1,2,2,0,2904,0,2,1,2,0,1,0
312,"          IF(node_flux(j,k,l).LT.0.0)THEN",6008009012,0,3300004950,1880002820,5500165,140000210,42501275,33501005,8253465,750315,3500210,0,4000240,190000570,50000075,1000015,3004,1811,180,0,330,188,79,0,0,256,11,14,85,1,3,280,218,67,33,3,14,0,16,38,5,1,33,14,16,85,11
313,            upwind=j+2,320000480,0,70000105,0,0,0,0,0,0,0,0,0,0,0,10000015,0,160,96,2,0,7,0,9,0,0,7,0,0,0,0,2,91,86,0,0,0,0,0,0,0,1,0,0,0,0,0,0
314,            donor=j+1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
315,            downwind=j,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
316,            dif=donor,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
317,          ELSE,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
318,            upwind=j-1,164000246,0,10000015,0,0,0,0,0,0,0,0,0,0,0,10000015,0,82,54,0,0,1,0,4,0,0,1,0,0,0,0,0,55,40,0,0,0,0,0,0,0,1,0,0,0,0,0,0
319,            donor=j,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
320,            downwind=j+1,36000054,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,18,8,1,0,0,0,0,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0
321,            dif=upwind,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
322,          ENDIF,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
323,"          sigma=ABS(node_flux(j,k,l))/(node_mass_pre(donor,k,l))",2346003519,0,1070001605,650000975,4500135,520000780,40501215,34001020,10254305,0,5000300,0,4750285,460001380,40000060,0,1173,647,70,0,107,65,56,0,0,101,9,52,81,0,0,192,197,68,41,0,20,0,19,92,4,0,41,20,19,81,9
324,          width=celldx(j),3600005400,0,2520003780,2290003435,0,70000105,0,500015,500210,250105,0,3000090,0,35000105,40000060,0,1800,1090,228,0,252,229,50,0,0,238,0,7,0,0,10,145,114,1,2,1,0,6,0,7,4,0,2,0,0,0,0
325,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
326,"          !----------- velocity difference, upwind and downwind -------------------------------------------------------------------",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
327,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
328,"          vdiffuw=vel1(donor,k,l)-vel1(upwind,k,l)",810001215,0,230000345,50000075,0,880001320,1500045,2000060,1000420,250105,0,0,750045,1055003165,0,0,405,227,2,0,23,5,15,0,0,14,0,88,3,0,0,105,61,4,4,1,0,0,3,211,0,0,4,0,3,3,0
329,"          vdiffdw=vel1(downwind,k,l)-vel1(donor,k,l)",968001452,0,70000105,50000075,500015,210000315,4500135,4500135,500210,0,250015,500015,750045,220000660,20000030,0,484,317,1,0,7,5,16,0,0,3,1,21,9,0,1,65,48,9,2,0,1,1,3,44,2,0,2,1,3,9,1
330,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
331,          !------------ start limiter calculation --------------------------------------------------------------------------------,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
332,          limiter=0.0,1332001998,0,320000480,80000120,0,0,0,0,0,0,0,500015,0,0,10000015,0,666,398,8,0,32,8,19,0,0,27,0,0,0,0,1,205,152,0,0,0,0,1,0,0,1,0,0,0,0,0,0
333,          IF(vdiffuw*vdiffdw.GT.0.0)THEN,2842004263,0,1010001515,390000585,0,0,0,0,0,250105,0,1000030,0,0,20000030,0,1421,801,19,0,101,39,31,0,0,68,0,0,0,0,4,165,188,0,0,1,0,2,0,0,2,0,0,0,0,0,0
334,"            ! Sid - absolute value of the velocity difference, upwind and downwind",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
335,            auw=ABS(vdiffuw),562000843,0,220000330,50000075,0,80000120,0,0,0,0,0,0,0,45000135,40000060,0,281,172,0,0,22,5,12,0,0,11,0,8,0,0,0,155,172,0,0,0,0,0,0,9,4,0,0,0,0,0,0
336,            adw=ABS(vdiffdw),978001467,0,310000465,50000075,0,30000045,0,0,0,0,0,0,0,50000150,0,0,489,284,0,0,31,5,10,0,0,9,0,3,0,0,0,273,281,0,0,0,0,0,0,10,0,0,0,0,0,0,0
337,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
338,            ! Sid - set wind = 1.0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
339,            wind=1.0_8,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
340,            IF(vdiffdw.LE.0.0) wind=-1.0_8,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
341,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
342,            !Sid - Wind is now set            ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
343,"            !sigma is the flux/pre mass, tmp1= 2/sigma",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
344,            !Sid - absolute value of downwind divided by width,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
345,            !Sid - Sigma + 1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
346,            !Sid - absolute value of upwind/celldx           ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
347,"            limiter=wind*MIN(width*((2.0_8-sigma)*adw/width+(1.0_8+sigma)*auw/celldx(dif))/6.0_8,auw,adw)",32484048726,0,5970008955,690001035,500015,12950019425,0,0,0,3001260,0,5000150,0,13485040455,850001275,0,16242,9812,20,0,597,69,478,0,0,367,1,1295,0,0,20,6126,5406,0,0,12,0,10,0,2697,85,0,0,0,0,0,0
348,            limiter_count=limiter_count+1,7430011145,0,1120001680,170000255,500015,0,0,0,0,2501050,0,1000030,0,0,800001200,0,3715,2178,9,0,112,17,100,0,0,95,1,0,0,0,0,1670,1388,0,0,10,0,2,0,0,80,0,0,0,0,0,0
349,          ENDIF,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
350,"          advec_vel_s=vel1(donor,k,l)+(1.0-sigma)*limiter",11432017148,0,1920002880,310000465,500015,0,0,0,0,1500630,0,1500045,0,0,260000390,10000150,5716,3270,13,0,192,31,282,0,0,152,1,0,0,0,6,2462,2185,0,0,6,0,3,0,0,26,10,0,0,0,0,0
351,"          mom_flux(j,k,l)=advec_vel_s*node_flux(j,k,l)",15216022824,0,3990005985,580000870,0,0,0,0,0,250105,0,0,0,0,120000180,2408036120,7608,4474,16,0,399,58,224,0,0,252,0,0,0,0,10,1408,1217,0,0,1,0,0,0,0,12,2408,0,0,0,0,0
352,        ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
353,      ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
354,    ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
355,!$OMP END DO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
356,!$OMP MASTER,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
357,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
358,   iter=(z_max-z_max+2)*(y_max-y_min+2)*(x_max-x_min+3),0,0,0,0,500015,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1
359,   tmpFlop=tmpFlop+(iter*10)+(limiter_count*19),2000003,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
360,   tmpMem=tmpMem+(iter*24)+(limiter_count*10),0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
361,   flop=flop+tmpFlop,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
362,   mem=mem+tmpMem,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
363,   tmpFlop=0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
364,   tmpMem=0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
365,!$OMP END MASTER,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
366,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
367,!------------------------------------ Limiter calculation complete ------------------------------------------------------,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
368,nb_x=x_max+1,2000003,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
369,nb_y=y_max+1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
370,nb_z=z_max+1,0,0,0,0,0,0,0,0,250105,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0
371,block_max=x_min+BLOCK_SIZE-1,0,0,0,10000015,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
372,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
373,!$OMP  DO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
374,"        DO bj=x_min,nb_x,BLOCK_SIZE",2000003,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
375,"        DO bk=y_min,nb_x,BLOCK_SIZE",4000006,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
376,"        DO bl=z_min,nb_y,BLOCK_SIZE",6000009,0,10000015,0,0,0,0,0,0,0,0,0,0,0,0,0,3,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
377,"        DO j=bj,block_max",2000003,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1000015,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,1,0,0,0,0,0
378,"        DO k=bk,block_max",4000006,0,0,0,0,0,1000030,0,0,250105,0,0,0,10000030,0,0,2,1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,1,0,0,1,0,0,0,2,0,0,0,0,0,2,0
379,"        DO l=bl,block_max",36000054,0,0,10000015,0,0,0,0,0,500210,0,1000030,0,0,0,0,18,6,1,0,0,1,3,0,0,1,0,0,0,0,0,0,0,0,0,2,0,2,0,0,0,0,0,0,0,0,0
380,        IF (j.LT.nb_x .AND. k.LT.nb_x .AND. l.LT.nb_x) THEN,6000009,0,0,0,0,0,0,0,250105,0,0,0,0,0,0,0,3,1,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0
381,"        vel1 (j,k,l)=(vel1 (j,k,l)*node_mass_pre(j,k,l)+mom_flux(j-1,k,l)-mom_flux(j,k,l))/node_mass_post(j,k,l)",2802004203,0,1990002985,1880002820,41001230,90000135,326009780,114003420,200084000,154814995,159259555,41501245,39002340,450001350,70000105,81001215,1401,816,194,0,199,188,191,0,0,195,82,9,652,0,3,152,111,228,800,619,637,83,156,90,7,81,800,637,155,652,82
382,        ENDIF,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
383,        ENDDO,76000114,0,20000030,40000060,0,0,0,0,0,2000840,0,0,0,0,0,0,38,17,1,0,2,4,1,0,0,2,0,0,0,0,0,1,2,0,0,8,0,0,0,0,0,0,0,0,0,0,0
384,        ENDDO,0,0,0,0,0,0,0,0,250105,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0
385,          ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
386,        ENDDO,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
387,      ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
388,    ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
389,!$OMP END DO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
390,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
391,!$OMP MASTER,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
392,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
393,  iter=(z_max-z_min+2)*(y_max-y_min+2)*(x_max-x_min+2),2000003,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
394,  tmpFlop=iter*7,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
395,  tmpMem=iter*6,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
396,  flop=flop+tmpFlop,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
397,  mem=mem+tmpMem,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
398,  tmpFlop=0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
399,  tmpMem=0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
400,!$OMP END MASTER,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
401,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
402,!------------------------------ Sid - Velocity calculation complete ------------------------------------------------------,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
403,!------------------------------ repeat the same logic below for direction 2 and direction 3 ------------------------------,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
404,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
405,  ELSEIF(direction.EQ.2)THEN,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
406,    IF(which_vel.EQ.1)THEN,0,0,10000015,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
407,!$OMP DO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
408,"      DO l=z_min,z_max+1",4000006,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
409,"        DO k=y_min-2,y_max+2",24000036,0,0,0,0,70000105,0,0,0,0,0,0,0,60000180,0,0,12,7,0,0,0,0,0,0,0,0,0,7,0,0,0,0,3,0,0,0,0,0,0,12,0,0,0,0,0,0,0
410,"          DO j=x_min,x_max+1",170000255,0,30000045,30000045,0,10000015,0,0,0,0,0,0,0,5000015,20000030,0,85,62,6,0,3,3,2,0,0,3,0,1,0,0,2,38,31,0,0,0,0,0,0,1,2,0,0,0,0,0,0
411,            ! Find staggered mesh mass fluxes and nodal masses and volumes.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
412,"            node_flux(j,k,l)=0.125_8*(mass_flux_y(j-1,k  ,l  )+mass_flux_y(j  ,k  ,l  ) &",1528002292,0,450000675,450000675,500015,2140003210,0,500015,0,2250945,250015,2000060,0,1985005955,120000180,361005415,764,454,34,0,45,45,71,0,0,41,1,214,0,1,8,366,279,1,0,9,1,4,0,397,12,361,0,1,0,0,1
413,"                                     +mass_flux_y(j-1,k+1,l  )+mass_flux_y(j  ,k+1,l  ) &",8864013296,0,6890010335,6770010155,1500045,850001275,10000300,6500195,8253465,2751155,3500210,500015,2000120,1005003015,120000180,0,4432,2628,699,0,689,677,159,0,0,731,3,85,20,1,4,457,341,13,33,11,14,1,8,201,12,0,33,14,8,20,3
414,"                                     +mass_flux_y(j-1,k  ,l-1)+mass_flux_y(j  ,k  ,l-1) &",850001275,0,500000750,370000555,0,800001200,500015,0,0,1000420,0,0,0,850002550,0,0,425,279,34,0,50,37,35,0,0,43,0,80,1,0,2,212,161,0,0,4,0,0,0,170,0,0,0,0,0,1,0
415,"                                     +mass_flux_y(j-1,k+1,l-1)+mass_flux_y(j  ,k+1,l-1))",1692002538,0,850001275,820001230,0,1530002295,12500375,7500225,1750735,1250525,2000120,1000030,500030,1935005805,70000105,0,846,564,73,0,85,82,50,0,0,100,0,153,25,0,3,285,203,15,7,5,8,2,2,387,7,0,7,8,2,25,0
416,          ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
417,        ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
418,      ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
419,!$OMP END DO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
420,!$OMP MASTER,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
421,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
422,      iter=(z_max-z_min+2)*(y_max-y_min+5)*(x_max-x_min+2),2000003,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
423,      tmpFlop=iter*8,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
424,      tmpMem=iter*9,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
425,      mem=mem+tmpMem,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
426,      flop=flop+tmpFlop,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
427,      tmpFlop=0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
428,      tmpMem=0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
429,!$OMP END MASTER,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
430,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
431,!$OMP DO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
432,"      DO l=z_min,z_max+1",2000003,0,0,10000015,0,0,500015,0,0,0,0,0,0,0,0,0,1,2,0,0,0,1,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0
433,"        DO k=y_min-1,y_max+2",20000030,0,10000015,30000045,0,80000120,0,0,0,0,0,0,0,105000315,0,0,10,8,2,0,1,3,1,0,0,3,0,8,0,0,0,1,0,0,0,0,0,0,0,21,0,0,0,0,0,0,0
434,"          DO j=x_min,x_max+1",536000804,0,160000240,130000195,0,0,0,0,0,250105,0,0,0,30000090,20000030,0,268,146,9,0,16,13,34,0,0,8,0,0,0,0,2,63,52,0,0,1,0,0,0,6,2,0,0,0,0,0,0
435,"            node_mass_post(j,k,l)=0.125_8*(density1(j  ,k-1,l  )*post_vol(j  ,k-1,l  )                     &",4410006615,0,2030003045,2080003120,0,7670011505,500015,0,500210,1500630,250015,1500045,250015,6680020040,80000120,370005550,2205,1365,205,0,203,208,170,0,0,202,0,767,1,1,8,668,546,0,2,6,1,3,1,1336,8,370,2,1,1,1,0
436,"                                          +density1(j  ,k  ,l  )*post_vol(j  ,k  ,l  )                     &",7914011871,0,6810010215,6460009690,2500075,380000570,12000360,7000210,5502310,1750735,3500210,0,4000240,705002115,40000060,0,3957,2339,645,0,681,646,130,0,0,663,5,38,24,0,7,350,267,14,22,7,14,0,16,141,4,0,22,14,16,24,5
437,"                                          +density1(j-1,k-1,l  )*post_vol(j-1,k-1,l  )                     &",964001446,0,240000360,210000315,0,1100001650,0,0,0,250105,0,0,0,1230003690,120000180,0,482,285,29,0,24,21,47,0,0,22,0,110,0,0,1,210,168,0,0,1,0,0,0,246,12,0,0,0,0,0,0
438,"                                          +density1(j-1,k  ,l  )*post_vol(j-1,k  ,l  )                     &",570000855,0,130000195,110000165,0,970001455,0,500015,250105,1000420,250015,0,250015,915002745,10000015,0,285,199,8,0,13,11,34,0,0,6,0,97,0,0,1,194,129,1,1,4,1,0,1,183,1,0,1,1,1,0,0
439,"                                          +density1(j  ,k-1,l-1)*post_vol(j  ,k-1,l-1)                     &",866001299,0,130000195,150000225,0,490000735,500015,0,250105,2501050,250015,3000090,0,610001830,0,0,433,288,17,0,13,15,39,0,0,13,0,49,1,0,0,286,210,0,1,10,1,6,0,122,0,0,1,1,0,1,0
440,"                                          +density1(j  ,k  ,l-1)*post_vol(j  ,k  ,l-1)                     &",1902002853,0,1000001500,990001485,1000030,710001065,11500345,7500225,4251785,750315,4500270,0,750045,660001980,10000015,0,951,517,85,0,100,99,50,0,0,119,2,71,23,0,4,250,151,15,17,3,18,0,3,132,1,0,17,18,3,23,2
441,"                                          +density1(j-1,k-1,l-1)*post_vol(j-1,k-1,l-1)                     &",818001227,0,180000270,140000210,0,410000615,0,0,0,0,0,0,0,485001455,0,0,409,276,7,0,18,14,48,0,0,18,0,41,0,0,4,271,192,0,0,0,0,0,0,97,0,0,0,0,0,0,0
442,"                                          +density1(j-1,k  ,l-1)*post_vol(j-1,k  ,l-1))",962001443,0,260000390,210000315,0,370000555,0,0,0,250105,0,0,0,510001530,70000105,0,481,301,10,0,26,21,69,0,0,26,0,37,0,0,2,374,297,0,0,1,0,0,0,102,7,0,0,0,0,0,0
443,          ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
444,        ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
445,      ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
446,!$OMP END DO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
447,!$OMP MASTER,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
448,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
449,      iter=(z_max-z_min+2)*(y_max-y_min+4)*(x_max-x_min+2),,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
450,      tmpFlop=iter*16,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
451,      tmpMem=iter*17,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
452,      flop=flop+tmpFlop,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
453,      mem=mem+tmpMem,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
454,      tmpMem=0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
455,      tmpFlop=0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
456,!$OMP END MASTER,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
457,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
458,!$OMP DO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
459,"      DO l=z_min,z_max+1",2000003,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
460,"        DO k=y_min-1,y_max+2",12000018,0,0,10000015,0,20000030,0,0,0,250105,0,0,0,20000060,0,0,6,1,2,0,0,1,0,0,0,1,0,2,0,0,0,2,0,0,0,1,0,0,0,4,0,0,0,0,0,0,0
461,"          DO j=x_min,x_max+1",92000138,0,90000135,100000150,0,0,0,0,0,750315,0,1500045,0,5000015,0,0,46,48,5,0,9,10,6,0,0,7,0,0,0,0,1,9,5,0,0,3,0,3,0,1,0,0,0,0,0,0,0
462,"            node_mass_pre(j,k,l)=node_mass_post(j,k,l)-node_flux(j,k-1,l)+node_flux(j,k,l)",16336024504,0,13930020895,13640020460,56501695,1070001605,117503525,24500735,91038220,31013020,37252235,51501545,57503450,1950005850,420000630,386005790,8168,4898,1379,0,1393,1364,384,0,0,1434,113,107,235,1,12,479,328,49,364,124,149,103,230,390,42,386,364,149,230,235,113
463,          ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
464,        ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
465,      ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
466,!$OMP END DO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
467,!$OMP MASTER,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
468,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
469,    iter=(z_max-z_min+2)*(y_max-y_min+4)*(x_max-x_min+2),,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
470,    tmpFlop=iter*2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
471,    tmpMem=iter*4,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
472,    flop=flop+tmpFlop,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
473,    mem=mem+tmpMem,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
474,    tmpFlop=0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
475,    tmpMem=0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
476,!$OMP END MASTER,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
477,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
478,ENDIF,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
479,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
480,limiter_count=0,2000003,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
481,"!$OMP DO PRIVATE(upwind,donor,downwind,dif,sigma,width,limiter,vdiffuw,vdiffdw,auw,adw,wind) REDUCTION (+:limiter_count)",2000003,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
482,"    DO l=z_min,z_max+1",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
483,"      DO k=y_min-1,y_max+1",38000057,0,20000030,10000015,0,10000015,0,0,0,0,0,0,0,55000165,0,0,19,10,2,0,2,1,4,0,0,1,0,1,0,0,1,3,3,0,0,0,0,0,0,11,0,0,0,0,0,0,0
484,"        DO j=x_min,x_max+1",1854002781,0,490000735,230000345,0,0,0,0,0,0,0,1000030,0,5000015,60000090,0,927,536,12,0,49,23,33,0,0,16,0,0,0,0,7,425,420,0,0,0,0,2,0,1,6,0,0,0,0,0,0
485,"          IF(node_flux(j,k,l).LT.0.0)THEN",4384006576,0,2520003780,2230003345,1500045,13510020265,5000150,2500075,2250945,1750735,750045,500015,1250075,13480040440,60000090,0,2192,1401,231,0,252,223,69,0,0,249,3,1351,10,0,3,538,465,5,9,7,3,1,5,2696,6,0,9,3,5,10,3
486,            upwind=k+2,198000297,0,20000030,10000015,0,410000615,0,0,0,0,0,0,0,300000900,0,0,99,50,0,0,2,1,2,0,0,3,0,41,0,0,4,4,6,0,0,0,0,0,0,60,0,0,0,0,0,0,0
487,            donor=k+1,140000210,0,30000045,0,0,0,0,0,0,0,0,0,0,0,0,0,70,49,1,0,3,0,3,0,0,1,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0
488,            downwind=k,44000066,0,0,0,0,210000315,0,0,0,0,0,0,0,180000540,0,0,22,7,0,0,0,0,1,0,0,0,0,21,0,0,0,0,0,0,0,0,0,0,0,36,0,0,0,0,0,0,0
489,            dif=donor,694001041,0,120000180,70000105,0,0,0,0,0,0,0,0,0,0,0,0,347,181,0,0,12,7,14,0,0,10,0,0,0,0,0,270,204,0,0,0,0,0,0,0,0,0,0,0,0,0,0
490,          ELSE,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
491,            upwind=k-1,440000660,0,120000180,40000060,0,870001305,0,0,0,250105,0,0,0,760002280,10000015,36000540,220,137,1,0,12,4,14,0,0,2,0,87,0,0,0,57,59,0,0,1,0,0,0,152,1,36,0,0,0,0,0
492,            donor=k,174000261,0,0,0,0,710001065,0,0,0,0,0,0,0,695002085,0,0,87,56,0,0,0,0,9,0,0,0,0,71,0,0,0,3,10,0,0,0,0,0,0,139,0,0,0,0,0,0,0
493,            downwind=k+1,22000033,0,30000045,0,0,0,0,0,0,0,0,0,0,0,0,0,11,14,0,0,3,0,0,0,0,1,0,0,0,0,0,6,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
494,            dif=upwind,988001482,0,150000225,40000060,0,400000600,0,0,0,0,0,0,0,425001275,10000015,0,494,294,1,0,15,4,24,0,0,14,0,40,0,0,1,320,274,0,0,0,0,0,0,85,1,0,0,0,0,0,0
495,          ENDIF,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
496,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
497,"          sigma=ABS(node_flux(j,k,l))/(node_mass_pre(j,donor,l))",4464006696,0,1050001575,1100001650,8500255,3910005865,48001440,19500585,18507770,0,5000300,2000060,6750405,4175012525,20000030,0,2232,1273,103,0,105,110,102,0,0,124,17,391,96,0,3,844,793,39,74,0,20,4,27,835,2,0,74,20,27,96,17
498,          width=celldy(k),16000024,0,0,0,0,0,0,500015,250105,0,250015,0,0,20000060,0,0,8,2,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,1,0,1,0,0,4,0,0,1,1,0,0,0
499,"          vdiffuw=vel1(j,donor,l)-vel1(j,upwind,l)",10948016422,0,6630009945,5610008415,5500165,2220003330,7500225,7000210,5002100,500210,1500090,0,2250135,1925005775,230000345,0,5474,3318,523,0,663,561,224,0,0,571,11,222,15,0,36,978,853,14,20,2,6,0,9,385,23,0,20,6,9,15,11
500,"          vdiffdw=vel1(j,downwind,l)-vel1(j,donor,l)",2192003288,0,180000270,30000045,1000030,70000105,1000030,1500045,250105,250105,0,1000030,750045,85000255,20000030,0,1096,629,1,0,18,3,55,0,0,8,2,7,2,0,0,549,423,3,1,1,0,2,3,17,2,0,1,0,3,2,2
501,          limiter=0.0,418000627,0,0,10000015,0,0,0,0,0,0,0,0,0,0,0,0,209,136,1,0,0,1,20,0,0,0,0,0,0,0,1,5,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0
502,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
503,          IF(vdiffuw*vdiffdw.GT.0.0)THEN,3674005511,0,1420002130,1090001635,0,0,0,0,0,750315,0,0,0,0,50000075,0,1837,1102,131,0,142,109,64,0,0,146,0,0,0,0,0,174,146,0,0,3,0,0,0,0,5,0,0,0,0,0,0
504,            auw=ABS(vdiffuw),270000405,0,30000045,10000015,0,10000015,0,0,0,0,0,0,0,0,0,0,135,108,0,0,3,1,10,0,0,2,0,1,0,0,1,9,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0
505,            adw=ABS(vdiffdw),634000951,0,50000075,10000015,0,1320001980,0,0,0,0,0,0,0,1220003660,0,0,317,183,0,0,5,1,11,0,0,1,0,132,0,0,2,25,29,0,0,0,0,0,0,244,0,0,0,0,0,0,0
506,            wind=1.0_8,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
507,            IF(vdiffdw.LE.0.0) wind=-1.0_8,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
508,"            limiter=wind*MIN(width*((2.0_8-sigma)*adw/width+(1.0_8+sigma)*auw/celldy(dif))/6.0_8,auw,adw)",22508033762,0,2320003480,840001260,0,4530006795,3500105,2000060,0,2501050,0,5500165,250015,4520013560,310000465,0,11254,6650,36,0,232,84,431,0,0,130,0,453,7,0,44,2544,2274,4,0,10,0,11,1,904,31,0,0,0,0,7,0
509,            limiter_count=limiter_count+1,246000369,0,30000045,0,0,0,0,0,0,0,0,0,250015,0,0,0,123,101,0,0,3,0,3,0,0,0,0,0,0,0,0,25,30,0,0,0,0,0,1,0,0,0,0,0,0,0,0
510,          ENDIF,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
511,"          advec_vel_s=vel1(j,donor,l)+(1.0_8-sigma)*limiter",11776017664,0,2020003030,710001065,0,180000270,0,0,250105,2250945,250015,2000060,500030,150000450,680001020,5000075,5888,3522,14,0,202,71,205,0,0,68,0,18,0,0,6,3689,3249,0,1,9,1,4,2,30,68,5,1,1,1,0,0
512,"          mom_flux(j,k,l)=advec_vel_s*node_flux(j,k,l)",9954014931,0,910001365,350000525,0,30000045,0,0,250105,1750735,0,500015,0,10000030,810001215,2357035355,4977,2872,11,0,91,35,180,0,0,83,0,3,0,2,6,3024,2784,0,1,7,0,1,0,2,81,2357,1,0,0,0,0
513,        ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
514,      ENDDO,24000036,0,10000015,0,0,20000030,0,0,0,0,0,0,0,5000015,0,0,12,6,0,0,1,0,1,0,0,0,0,2,0,0,0,1,3,0,0,0,0,0,0,1,0,0,0,0,0,0,0
515,    ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
516,!$OMP END DO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
517,!$OMP MASTER,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
518,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
519,  iter=(z_max-z_max+2)*(y_max-y_min+3)*(x_max-x_min+2),0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
520,  tmpFlop=tmpFlop+(iter*9)+(limiter_count*19),4000006,0,0,10000015,0,0,0,0,0,0,0,0,0,0,0,0,2,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
521,  tmpMem=tmpMem+(iter*24)+(limiter_count*20),,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
522,  flop=flop+tmpFlop,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
523,  mem=mem+tmpMem,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
524,  tmpFlop=0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
525,  tmpMem=0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
526,!$OMP END MASTER,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
527, ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
528,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
529,!###################################,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
530,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
531,nb_x=x_max+1,4000006,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
532,nb_y=y_max+1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
533,nb_z=z_max+1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
534,block_max=x_min+BLOCK_SIZE-1,0,0,0,10000015,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
535,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
536,!$OMP  DO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
537,"DO bj=x_min,nb_x,BLOCK_SIZE",0,0,10000015,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
538,"   DO bk=y_min,nb_x,BLOCK_SIZE",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
539,"      DO bl=z_min,nb_y,BLOCK_SIZE",2000003,0,0,10000015,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
540,"        DO j=bj,block_max",0,0,0,0,0,0,0,0,0,0,0,0,0,5000015,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0
541,"            DO k=bk,block_max",2000003,0,0,0,0,10000015,0,0,0,0,0,500015,0,20000060,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,1,0,4,0,0,0,0,0,0,0
542,"                DO l=bl,block_max",34000051,0,10000015,20000030,0,0,0,0,0,1250525,0,1000030,0,0,0,0,17,9,1,0,1,2,0,0,0,2,0,0,0,0,0,1,0,0,0,5,0,2,0,0,0,0,0,0,0,0,0
543,                    IF (j.LT.nb_x .AND. k.LT.nb_x .AND. l.LT.nb_x) THEN,22000033,0,20000030,20000030,0,0,0,0,0,500210,0,1000030,0,0,0,0,11,6,2,0,2,2,1,0,0,1,0,0,0,0,0,1,1,0,0,2,0,2,0,0,0,0,0,0,0,0,0
544,"                        vel1 (j,k,l)=(vel1(j,k,l)*node_mass_pre(j,k,l)+mom_flux(j,k-1,l)-mom_flux(j,k,l))/node_mass_post(j,k,l)",2946004419,0,2040003060,2140003210,43001290,300000450,321009630,132003960,188078960,147561950,148008880,36501095,41002460,535001605,120000180,84001260,1473,800,192,0,204,214,189,0,0,213,86,30,642,0,4,154,108,264,752,590,592,73,164,107,12,84,751,591,164,642,86
545,                    ENDIF,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
546,                ENDDO,20000030,0,10000015,20000030,0,0,0,0,0,1000420,0,2000060,0,0,0,0,10,12,3,0,1,2,1,0,0,2,0,0,0,0,0,0,1,0,0,4,0,4,0,0,0,0,0,0,0,0,0
547,            ENDDO,4000006,0,0,10000015,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
548,          ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
549,        ENDDO,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
550,      ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
551,    ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
552,!$OMP END DO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
553,!$OMP MASTER,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
554,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
555,  iter=(z_max-z_min+2)*(y_max-y_min+2)*(x_max-x_min+2),,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
556,  tmpFlop=iter*7,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
557,  tmpMem=iter*6,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
558,  flop=flop+tmpFlop,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
559,  mem=mem+tmpMem,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
560,  tmpFlop=0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
561,  tmpMem=0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
562,!$OMP END MASTER,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
563,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
564,  ELSEIF(direction.EQ.3)THEN,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
565,    IF(which_vel.EQ.1) THEN,0,0,0,10000015,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
566,!$OMP DO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
567,"      DO l=z_min-2,z_max+2",0,0,10000015,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
568,"        DO k=y_min,y_max+1",10000015,0,0,10000015,0,40000060,0,0,0,0,0,0,0,45000135,0,0,5,1,0,0,0,1,0,0,0,0,0,4,0,0,0,2,2,0,0,0,0,0,0,9,0,0,0,0,0,0,0
569,"          DO j=x_min,x_max+1",172000258,0,40000060,40000060,0,10000015,0,0,0,0,0,0,0,10000030,10000015,0,86,41,3,0,4,4,4,0,0,0,0,1,0,0,1,42,26,0,0,0,0,0,0,2,1,0,0,0,0,0,0
570,            ! Find staggered mesh mass fluxes and nodal masses and volumes.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
571,"            node_flux(j,k,l)=0.125_8*(mass_flux_z(j-1,k  ,l  )+mass_flux_z(j  ,k  ,l  ) &",2572003858,0,1200001800,830001245,0,1950002925,22500675,15000450,4251785,3751575,4250255,0,0,2020006060,110000165,376005640,1286,805,114,0,120,83,73,0,0,98,0,195,45,9,8,434,309,30,17,15,17,0,0,404,11,376,17,17,0,45,0
572,"                                     +mass_flux_z(j-1,k  ,l+1)+mass_flux_z(j  ,k  ,l+1) &",8438012657,0,6770010155,6770010155,3000090,710001065,14500435,5500165,7503150,3751575,4750285,500015,2500150,1305003915,110000165,0,4219,2552,634,0,677,677,169,0,0,688,6,71,29,2,2,470,340,11,30,15,19,1,10,261,11,0,30,19,10,29,6
573,"                                     +mass_flux_z(j-1,k-1,l  )+mass_flux_z(j  ,k-1,l  ) &",992001488,0,530000795,270000405,0,870001305,0,0,0,1250525,0,500015,0,660001980,10000015,0,496,317,49,0,53,27,31,0,0,55,0,87,0,0,1,165,133,0,0,5,0,1,0,132,1,0,0,0,0,0,0
574,"                                     +mass_flux_z(j-1,k-1,l+1)+mass_flux_z(j  ,k-1,l+1))",858001287,0,280000420,260000390,500015,1360002040,0,0,0,1000420,0,1000030,500030,1865005595,80000120,0,429,295,24,0,28,26,36,0,0,31,1,136,0,0,1,221,168,0,0,4,0,2,2,373,8,0,0,0,2,0,1
575,          ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
576,        ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
577,      ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
578,!$OMP END DO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
579,!$OMP MASTER,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
580,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
581,      iter=(z_max-z_min+5)*(y_max-y_min+2)*(x_max-x_min+2),,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
582,      tmpFlop=iter*8,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
583,      tmpMem=iter*9,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
584,      flop=flop+tmpFlop,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
585,      mem=mem+tmpMem,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
586,      tmpFlop=0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
587,      tmpMem=0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
588,!$OMP END MASTER,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
589,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
590,!$OMP DO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
591,"      DO l=z_min-1,z_max+2",2000003,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
592,"        DO k=y_min,y_max+1",28000042,0,10000015,10000015,0,70000105,0,0,0,0,250015,0,0,50000150,0,0,14,10,1,0,1,1,0,0,0,0,0,7,0,0,0,2,4,0,0,0,1,0,0,10,0,0,0,1,0,0,0
593,"          DO j=x_min,x_max+1",492000738,0,90000135,80000120,0,30000045,0,0,0,0,250015,0,250015,40000120,0,0,246,162,8,0,9,8,31,0,0,10,0,3,0,0,3,91,68,0,0,0,1,0,1,8,0,0,0,1,1,0,0
594,"            node_mass_post(j,k,l)=0.125_8*(density1(j  ,k-1,l  )*post_vol(j  ,k-1,l  )                     &",4444006666,0,2250003375,2070003105,500015,7170010755,500015,0,1000420,1250525,0,2000060,250015,6710020130,100000150,379005685,2222,1323,217,0,225,207,163,0,0,227,1,717,1,0,5,669,527,0,4,5,0,4,1,1342,10,379,4,0,1,1,1
595,"                                          +density1(j  ,k  ,l  )*post_vol(j  ,k  ,l  )                     &",8048012072,0,6890010335,6940010410,4000120,440000660,14500435,4500135,6752835,1750735,2250135,1000030,2000120,665001995,70000105,0,4024,2434,670,0,689,694,153,0,0,650,8,44,29,0,5,329,264,9,27,7,9,2,8,133,7,0,27,9,8,29,8
596,"                                          +density1(j-1,k-1,l  )*post_vol(j-1,k-1,l  )                     &",978001467,0,320000480,170000255,0,1330001995,0,0,0,750315,0,0,0,1230003690,60000090,0,489,307,24,0,32,17,45,0,0,36,0,133,0,0,3,240,155,0,0,3,0,0,0,246,6,0,0,0,0,0,0
597,"                                          +density1(j-1,k  ,l  )*post_vol(j-1,k  ,l  )                     &",660000990,0,140000210,80000120,0,1130001695,0,0,250105,1500630,0,0,250015,1165003495,40000060,0,330,198,9,0,14,8,38,0,0,11,0,113,0,0,1,177,126,0,1,6,0,0,1,233,4,0,1,0,1,0,0
598,"                                          +density1(j  ,k-1,l-1)*post_vol(j  ,k-1,l-1)                     &",848001272,0,160000240,110000165,500015,490000735,0,0,500210,2250945,250015,500015,500030,555001665,30000045,0,424,263,12,0,16,11,54,0,0,10,1,49,0,0,2,276,192,0,2,9,1,1,2,111,3,0,2,1,1,0,1
599,"                                          +density1(j  ,k  ,l-1)*post_vol(j  ,k  ,l-1)                     &",1692002538,0,1040001560,1000001500,1500045,420000630,11000330,6500195,4001680,1000420,3000180,0,250015,630001890,10000015,0,846,521,103,0,104,100,38,0,0,100,3,42,22,0,1,207,163,13,16,4,12,0,1,126,1,0,16,12,1,22,3
600,"                                          +density1(j-1,k-1,l-1)*post_vol(j-1,k-1,l-1)                     &",900001350,0,90000135,100000150,0,430000645,0,0,0,250105,0,0,0,435001305,10000015,0,450,244,6,0,9,10,41,0,0,9,0,43,0,0,4,269,196,0,0,1,0,0,0,87,1,0,0,0,0,0,0
601,"                                          +density1(j-1,k  ,l-1)*post_vol(j-1,k  ,l-1))",998001497,0,280000420,210000315,0,600000900,500015,0,0,0,0,500015,0,585001755,60000090,0,499,281,16,0,28,21,57,0,0,12,0,60,1,0,0,378,294,0,0,0,0,1,0,117,6,0,0,0,0,1,0
602,          ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
603,        ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
604,      ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
605,!$OMP END DO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
606,!$OMP MASTER,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
607,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
608,      iter=(z_max-z_min+4)*(y_max-y_min+2)*(x_max-x_min+2),2000003,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
609,      tmpFlop=iter*16,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
610,      tmpMem=iter*17,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
611,      mem=mem+tmpMem,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
612,      flop=flop+tmpFlop,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
613,      tmpFlop=0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
614,      tmpMem=0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
615,!$OMP END MASTER,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
616,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
617,!$OMP DO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
618,"      DO l=z_min-1,z_max+2",8000012,0,20000030,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
619,"        DO k=y_min,y_max+1",14000021,0,30000045,10000015,0,40000060,0,0,0,250105,0,0,0,40000120,0,0,7,3,0,0,3,1,0,0,0,0,0,4,0,0,0,0,0,0,0,1,0,0,0,8,0,0,0,0,0,0,0
620,"          DO j=x_min,x_max+1",168000252,0,130000195,100000150,0,10000015,0,0,0,1000420,0,1000030,0,5000015,0,0,84,39,13,0,13,10,10,0,0,8,0,1,0,0,0,10,7,0,0,4,0,2,0,1,0,0,0,0,0,0,0
621,            ! Staggered cell mass pre advection,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
622,"            node_mass_pre(j,k,l)=node_mass_post(j,k,l)-node_flux(j,k,l-1)+node_flux(j,k,l)",16660024990,0,14020021030,13920020880,61501845,690001035,165004950,56501695,114297985,55523310,55753345,56001680,50753045,1825005475,320000480,388005820,8330,5000,1392,0,1402,1392,506,0,0,1460,123,69,330,0,12,449,314,113,457,222,223,112,203,365,32,388,457,223,203,330,123
623,          ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
624,        ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
625,      ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
626,!$OMP END DO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
627,!$OMP MASTER,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
628,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
629,    iter=(z_max-z_min+4)*(y_max-y_min+2)*(x_max-x_min+2),,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
630,    tmpFlop=iter*2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
631,    tmpMem=iter*4,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
632,    flop=flop+tmpFlop,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
633,    mem=mem+tmpMem,2000003,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
634,    tmpFlop=0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
635,    tmpMem=0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
636,!$OMP END MASTER,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
637,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
638,ENDIF,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
639,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
640,limiter_count=0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
641,"!$OMP DO PRIVATE(upwind,donor,downwind,dif,sigma,width,limiter,vdiffuw,vdiffdw,auw,adw,wind) REDUCTION (+:limiter_count)",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
642,"    DO l=z_min-1,z_max+1",8000012,0,0,10000015,0,0,0,0,0,0,0,0,0,0,0,0,4,2,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
643,"      DO k=y_min,y_max+1",36000054,0,10000015,20000030,0,40000060,500015,0,250105,0,250015,0,0,35000105,0,0,18,17,1,0,1,2,5,0,0,3,0,4,1,0,1,9,6,0,1,0,1,0,0,7,0,0,1,1,0,1,0
644,"        DO j=x_min,x_max+1",1964002946,0,430000645,200000300,0,200000300,4500135,1500045,500210,500210,250015,500015,250015,175000525,50000075,2000030,982,580,11,0,43,20,46,0,0,24,0,20,9,0,7,491,430,3,2,2,1,1,1,35,5,2,2,1,1,8,0
645,"          IF(node_flux(j,k,l).LT.0.0)THEN",4304006456,0,2180003270,1730002595,500015,13360020040,12000360,5000150,1000420,2501050,1500090,500015,2250135,13310039930,110000165,31000465,2152,1256,196,0,218,173,114,0,0,233,1,1336,24,0,4,531,404,10,4,10,6,1,9,2662,11,31,4,6,9,24,1
646,            upwind=l+2,20000030,0,0,10000015,0,470000705,0,0,0,0,0,500015,0,385001155,0,0,10,0,0,0,0,1,0,0,0,0,0,47,0,0,0,2,1,0,0,0,0,1,0,77,0,0,0,0,0,0,0
647,            donor=l+1,128000192,0,10000015,10000015,0,0,0,0,0,0,0,0,0,0,0,0,64,28,1,0,1,1,5,0,0,0,0,0,0,0,1,6,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0
648,            downwind=l,552000828,0,50000075,30000045,0,0,0,0,0,0,0,500015,0,0,10000015,0,276,189,1,0,5,3,9,0,0,4,0,0,0,0,0,173,160,0,0,0,0,1,0,0,1,0,0,0,0,0,0
649,            dif=donor,130000195,0,0,0,0,520000780,0,0,0,0,0,0,0,535001605,0,0,65,49,0,0,0,0,7,0,0,0,0,52,0,0,0,5,7,0,0,0,0,0,0,107,0,0,0,0,0,0,0
650,          ELSE,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
651,            upwind=l-1,180000270,0,50000075,20000030,0,370000555,0,0,0,500210,0,0,0,260000780,10000015,0,90,59,2,0,5,2,7,0,0,1,0,37,0,0,1,50,34,0,0,2,0,0,0,52,1,0,0,0,0,0,0
652,            donor=l,22000033,0,10000015,0,0,0,0,0,0,0,0,0,0,0,0,0,11,5,0,0,1,0,1,0,0,2,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
653,            downwind=l+1,1036001554,0,120000180,10000015,0,0,0,0,0,500210,0,0,0,0,40000060,0,518,313,1,0,12,1,29,0,0,7,0,0,0,0,0,301,291,0,0,2,0,0,0,0,4,0,0,0,0,0,0
654,            dif=upwind,194000291,0,0,0,0,1040001560,0,0,0,0,0,0,0,1110003330,0,0,97,55,0,0,0,0,13,0,0,0,0,104,0,0,0,6,4,0,0,0,0,0,0,222,0,0,0,0,0,0,0
655,          ENDIF,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
656,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
657,"          sigma=ABS(node_flux(j,k,l))/(node_mass_pre(j,k,donor))",4496006744,0,1830002745,1690002535,10000300,3530005295,67502025,36001080,20758715,0,16250975,0,13000780,3685011055,40000060,0,2248,1307,137,0,183,169,164,0,0,172,20,353,135,0,5,665,568,72,83,0,65,0,52,737,4,0,83,65,52,135,20
658,          width=celldz(l),14000021,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
659,"          vdiffuw=vel1(j,k,donor)-vel1(j,k,upwind)",13818020727,0,7880011820,7630011445,5500165,1540002310,44501335,36001080,17757455,2250945,14500870,5000150,6750405,1310003930,140000210,1000015,6909,4071,685,0,788,763,368,0,0,732,11,154,89,1,29,1287,1173,72,71,9,58,10,27,262,14,1,71,58,27,89,10
660,"          vdiffdw=vel1(j,k,downwind)-vel1(j,k,donor)",1376002064,0,120000180,80000120,2000060,30000045,14000420,7500225,3501470,750315,2000120,0,500030,50000150,20000030,0,688,437,4,0,12,8,58,0,0,11,4,3,28,0,1,237,194,15,14,3,8,0,2,10,2,0,14,8,2,28,4
661,          limiter=0.0,756001134,0,70000105,50000075,0,0,0,0,0,0,0,0,0,0,10000015,0,378,221,1,0,7,5,34,0,0,7,0,0,0,0,0,189,174,0,0,0,0,0,0,0,1,0,0,0,0,0,0
662,          IF(vdiffuw*vdiffdw.GT.0.0)THEN,4854007281,0,3090004635,2650003975,0,0,0,0,0,250105,0,2000060,0,0,30000045,0,2427,1552,249,0,309,265,146,0,0,265,0,0,0,0,4,197,141,0,0,1,0,4,0,0,3,0,0,0,0,0,0
663,            auw=ABS(vdiffuw),720001080,0,70000105,60000090,0,10000015,0,0,0,0,0,0,0,10000030,0,0,360,261,0,0,7,6,22,0,0,3,0,1,0,0,2,234,189,0,0,0,0,0,0,2,0,0,0,0,0,0,0
664,            adw=ABS(vdiffdw),642000963,0,140000210,50000075,0,1330001995,0,0,0,0,0,0,0,1400004200,0,0,321,217,1,0,14,5,34,0,0,0,0,133,0,0,3,104,95,0,0,0,0,0,0,280,0,0,0,0,0,0,0
665,            wind=1.0_8,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
666,            IF(vdiffdw.LE.0.0) wind=-1.0_8,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
667,"            limiter=wind*MIN(width*((2.0_8-sigma)*adw/width+(1.0_8+sigma)*auw/celldz(dif))/6.0_8,auw,adw)",21272031908,0,2120003180,1040001560,0,4320006480,500015,500015,250105,16006720,250015,7000210,0,4675014025,340000510,0,10636,6412,55,0,212,104,764,0,0,101,0,432,1,0,20,2063,1843,1,1,64,1,14,0,935,34,0,1,1,0,1,0
668,            limiter_count=limiter_count+1,450000675,0,10000015,20000030,0,0,0,0,0,0,0,0,0,0,0,0,225,125,0,0,1,2,13,0,0,0,0,0,0,0,1,47,49,0,0,0,0,0,0,0,0,0,0,0,0,0,0
669,          ENDIF,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
670,"          advec_vel_s=vel1(j,k,donor)+(1.0_8-sigma)*limiter",11756017634,0,2230003345,830001245,0,0,0,0,0,4001680,0,1500045,0,5000015,870001305,12000180,5878,3459,16,0,223,83,399,0,0,87,0,0,0,0,13,3602,3192,0,0,16,0,3,0,1,87,12,0,0,0,0,0
671,"          mom_flux(j,k,l)=advec_vel_s*node_flux(j,k,l)",9798014697,0,1030001545,370000555,0,0,0,0,0,3001260,0,0,0,0,900001350,2355035325,4899,2865,22,0,103,37,271,0,0,76,0,0,0,0,15,2992,2796,0,0,12,0,0,0,0,90,2355,0,0,0,0,0
672,        ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
673,      ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
674,    ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
675,!$OMP END DO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
676,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
677,!$OMP MASTER,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
678,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
679,  iter=(z_max-z_max+2)*(y_max-y_min+2)*(x_max-x_min+3),,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
680,  tmpFlop=tmpFlop+(iter*10)+(limiter_count*18),,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
681,  tmpMem=tmpMem+(iter*24)+(limiter_count*20),,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
682,  flop=flop+tmpFlop,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
683,  mem=mem+tmpMem,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
684,  tmpFlop=0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
685,  tmpMem=0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
686,!$OMP END MASTER,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
687,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
688,!###############################################,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
689,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
690,nb_x=x_max+1,0,0,0,10000015,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
691,nb_y=y_max+1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
692,nb_z=z_max+1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
693,block_max=x_min+BLOCK_SIZE-1,0,0,10000015,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
694,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
695,!$OMP  DO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
696,"DO bj=x_min,nb_x,BLOCK_SIZE",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
697,"   DO bk=y_min,nb_x,BLOCK_SIZE",4000006,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
698,"      DO bl=z_min,nb_y,BLOCK_SIZE",4000006,0,0,0,0,0,0,0,250105,0,0,0,0,0,0,0,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0
699,"        DO j=bj,block_max",4000006,0,10000015,0,0,0,0,0,0,0,0,0,0,5000015,0,1000015,2,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,1,0,1,0,0,0,0,0
700,"            DO k=bk,block_max",0,0,10000015,0,0,10000015,0,0,0,0,0,0,0,5000015,0,0,0,1,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0
701,"                DO l=bl,block_max",28000042,0,10000015,20000030,0,0,0,0,0,1250525,0,500015,0,0,0,0,14,9,1,0,1,2,3,0,0,2,0,0,0,0,0,0,1,0,0,5,0,1,0,0,0,0,0,0,0,0,0
702,                    IF (j.LT.nb_x .AND. k.LT.nb_x .AND. l.LT.nb_x) THEN,8000012,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
703,"                        vel1 (j,k,l)=(vel1(j,k,l)*node_mass_pre(j,k,l)+mom_flux(j,k,l-1)-mom_flux(j,k,l))/node_mass_post(j,k,l)",3038004557,0,1970002955,2120003180,37001110,110000165,297008910,114003420,180325705,152313945,150759045,34501035,39002340,540001620,110000165,96001440,1519,869,192,0,197,212,207,0,0,208,74,11,594,0,2,137,106,228,721,609,603,69,156,108,11,96,721,603,156,594,74
704,                    ENDIF,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
705,                ENDDO,28000042,0,30000045,10000015,0,0,0,0,0,1000420,0,1000030,0,0,0,0,14,9,1,0,3,1,2,0,0,3,0,0,0,0,0,3,1,0,0,4,0,2,0,0,0,0,0,0,0,0,0
706,            ENDDO,6000009,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
707,          ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
708,        ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
709,      ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
710,    ENDDO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
711,!$OMP END DO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
712,!###############################################,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
713,!$OMP MASTER,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
714,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
715,  iter=(z_max-z_min+2)*(y_max-y_min+2)*(x_max-x_min+2),,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
716,  tmpFlop=iter*7,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
717,  tmpMem=iter*6,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
718,!$OMP END MASTER,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
719,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
720,  ENDIF,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
721,!$OMP MASTER,2000003,0,10000015,0,0,0,0,0,0,0,0,0,0,0,0,1000015,1,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0
722,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
723,  flop=flop+tmpFlop,2000003,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
724,  mem=mem+tmpMem,0,0,10000015,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
725,  !$OMP END MASTER,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
726,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
727,!$OMP END PARALLEL,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
728,END SUBROUTINE advec_mom_kernel,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
729,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
730,END MODULE advec_mom_kernel_mod,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
